# Supabase Setup Guide\n\nThis guide helps you set up separate databases for staging and production in Supabase.\n\n## Option 1: Single Supabase Project with Multiple Databases\n\n### Steps:\n\n1. **Create a Supabase project** at [supabase.com](https://supabase.com)\n\n2. **Get your credentials:**\n   - Go to Settings → API\n   - Copy your **Project URL** and **anon public key**\n   - Go to Settings → Database  \n   - Copy your **Connection string**\n\n3. **Create staging database:**\n   ```sql\n   -- Connect to your Supabase database using the SQL Editor\n   CREATE DATABASE aipocket_staging;\n   ```\n\n4. **Update connection strings:**\n   - **Production**: Use the default database (usually `postgres`)\n   - **Staging**: Modify the connection string to use `aipocket_staging`\n\n   Example:\n   ```\n   # Production\n   postgresql://postgres:password@db.project.supabase.co:5432/postgres\n   \n   # Staging  \n   postgresql://postgres:password@db.project.supabase.co:5432/aipocket_staging\n   ```\n\n## Option 2: Separate Supabase Projects\n\n### Steps:\n\n1. **Create two Supabase projects:**\n   - `your-app-staging`\n   - `your-app-production`\n\n2. **Configure each project:**\n   - Set up authentication settings\n   - Configure any necessary extensions\n   - Set up RLS policies if needed\n\n3. **Use separate credentials:**\n   - Each project will have its own URL, key, and database connection string\n   - Update your `.env.staging` and `.env.production` files accordingly\n\n## Recommended Approach\n\n**For small to medium projects**: Use Option 1 (single project, multiple databases)\n**For large projects or strict isolation**: Use Option 2 (separate projects)\n\n## Environment File Configuration\n\nAfter setting up Supabase, update your environment files:\n\n### .env.local\n```bash\nENVIRONMENT=development\nSUPABASE_URL=https://your-project.supabase.co\nSUPABASE_KEY=your-anon-key\n# Local database settings (don't change these)\nDATABASE_URL=postgresql://postgres:postgres@localhost:5432/aipocket_local\n```\n\n### .env.staging\n```bash\nENVIRONMENT=staging\nSUPABASE_URL=https://your-project.supabase.co\nSUPABASE_KEY=your-anon-key\nDATABASE_URL=postgresql://postgres:password@db.project.supabase.co:5432/aipocket_staging\nSUPABASE_DB_STRING=postgresql://postgres:password@db.project.supabase.co:5432/aipocket_staging\n```\n\n### .env.production\n```bash\nENVIRONMENT=production\nSUPABASE_URL=https://your-project.supabase.co\nSUPABASE_KEY=your-anon-key\nDATABASE_URL=postgresql://postgres:password@db.project.supabase.co:5432/postgres\nSUPABASE_DB_STRING=postgresql://postgres:password@db.project.supabase.co:5432/postgres\n```\n\n## Testing the Setup\n\nRun the environment test script:\n\n```bash\n# Test all environments\npython test_environments.py\n\n# Test specific environment\nENVIRONMENT=staging python test_environments.py\n```\n\n## Next Steps\n\n1. Set up your Supabase project(s)\n2. Configure your environment files\n3. Run `make dev` to start local development\n4. Deploy to staging and production as needed